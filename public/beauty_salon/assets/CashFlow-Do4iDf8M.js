import{r as f,j as M,l as S,c as d,a as t,e as v,v as k,t as r,d as T,F,p as N,o as l,n as B}from"./index-ry9e-rOz.js";const R={class:"max-w-7xl mx-auto space-y-6"},V={class:"bg-white p-4 rounded-xl shadow-sm border border-gray-100 space-y-4"},j={class:"flex flex-col sm:flex-row sm:items-center gap-3"},L={class:"flex items-center gap-2 flex-1"},O={class:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden"},U={class:"border-b border-gray-100 px-6 py-4 flex items-center justify-between"},E={class:"text-xs font-medium bg-gray-100 text-gray-600 px-2 py-1 rounded-lg"},z={class:"overflow-x-auto"},A={class:"w-full text-left text-sm border-collapse"},H={class:"divide-y divide-gray-50"},W={key:0,class:"animate-pulse"},q={key:1},G={class:"px-6 py-3 whitespace-nowrap text-gray-600 font-mono text-xs"},J={class:"px-6 py-3 font-medium text-gray-800"},K={class:"px-6 py-3 text-gray-700"},Q={class:"px-6 py-3"},X={class:"px-6 py-3 text-right"},Y={class:"font-bold text-emerald-600"},Z={key:0,class:"text-xs text-gray-500 mt-0.5"},et={__name:"CashFlow",setup($){const u=f(!0),p=f([]),C=f(0),m=new Date,h=new Date(m);h.setDate(m.getDate()-6);const _=s=>s.toISOString().split("T")[0],o=M({startDate:_(h),endDate:_(m)});async function D(){const s=new Date(o.startDate),e=new Date(o.endDate),a=Math.abs(e-s);if(Math.ceil(a/(1e3*60*60*24))>7){alert(`âŒ Rentang tanggal maksimal 7 hari!
Silakan pilih periode yang lebih pendek.`);return}u.value=!0;try{const n=await(await fetch("/api/Beauty_Salon/Orders")).json();n.success&&I(n.data)}catch(i){console.error(i)}finally{u.value=!1}}function I(s){const e=new Date(o.startDate),a=new Date(o.endDate);a.setHours(23,59,59);let x=0;const i=[];s.forEach(n=>{if(n.status!=="completed")return;const c=y(n);if(c<=0)return;const b=n.order_date||n.created_at;if(!b)return;const w=new Date(b);w>=e&&w<=a&&(x+=c,i.push(n))}),i.sort((n,c)=>new Date(c.order_date||c.created_at)-new Date(n.order_date||n.created_at)),C.value=x,p.value=i}function y(s){const e=Number(s.pay_cash)||0,a=Number(s.pay_non_cash)||0;return e+a}function g(s){return new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(s)}function P(s){if(!s)return"-";const e=new Date(s);return e.toLocaleDateString("id-ID",{day:"numeric",month:"short"})+" "+e.toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit"})}return S(()=>{D()}),(s,e)=>(l(),d("div",R,[t("div",V,[e[3]||(e[3]=t("div",null,[t("h1",{class:"text-2xl font-bold text-gray-800"},"Riwayat Pembayaran"),t("p",{class:"text-sm text-gray-500"},"Transaksi pembayaran tunai (Maksimal rentang 1 minggu)")],-1)),t("div",j,[t("div",L,[v(t("input",{type:"date","onUpdate:modelValue":e[0]||(e[0]=a=>o.startDate=a),class:"flex-1 border rounded-lg px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-pink-200"},null,512),[[k,o.startDate]]),e[2]||(e[2]=t("span",{class:"text-gray-400 flex-shrink-0"},"-",-1)),v(t("input",{type:"date","onUpdate:modelValue":e[1]||(e[1]=a=>o.endDate=a),class:"flex-1 border rounded-lg px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-pink-200"},null,512),[[k,o.endDate]])]),t("button",{onClick:D,class:"bg-pink-600 hover:bg-pink-700 text-white px-6 py-2 rounded-lg text-sm font-medium transition shadow-lg shadow-pink-200 whitespace-nowrap sm:flex-shrink-0"}," Filter ")])]),t("div",O,[t("div",U,[e[4]||(e[4]=t("h3",{class:"font-bold text-gray-800"},"Riwayat Pembayaran",-1)),t("span",E,r(p.value.length)+" Transaksi",1)]),t("div",z,[t("table",A,[e[7]||(e[7]=t("thead",{class:"bg-gray-50 text-xs font-semibold text-gray-500 uppercase tracking-wider border-b"},[t("tr",null,[t("th",{class:"px-6 py-4"},"Tanggal & Waktu"),t("th",{class:"px-6 py-4"},"Order ID"),t("th",{class:"px-6 py-4"},"Pelanggan"),t("th",{class:"px-6 py-4"},"Metode Bayar"),t("th",{class:"px-6 py-4 text-right"},"Total Pembayaran")])],-1)),t("tbody",H,[u.value?(l(),d("tr",W,[...e[5]||(e[5]=[t("td",{colspan:"5",class:"px-6 py-8 text-center text-gray-400"},"Memuat data...",-1)])])):p.value.length===0?(l(),d("tr",q,[...e[6]||(e[6]=[t("td",{colspan:"5",class:"px-6 py-8 text-center text-gray-400"},"Tidak ada transaksi tunai pada periode ini",-1)])])):T("",!0),(l(!0),d(F,null,N(p.value,a=>(l(),d("tr",{key:a.id,class:"hover:bg-gray-50 transition duration-150"},[t("td",G,r(P(a.order_date||a.created_at)),1),t("td",J," #"+r(a.id),1),t("td",K,r(a.customer_name),1),t("td",Q,[t("span",{class:B(["inline-flex items-center px-2 py-0.5 rounded text-xs font-medium",a.payment_method==="tunai"?"bg-emerald-100 text-emerald-800":"bg-orange-100 text-orange-800"])},r((a.payment_method||"Tunai").toUpperCase()),3)]),t("td",X,[t("div",Y,r(g(y(a))),1),a.payment_method!=="tunai"?(l(),d("div",Z," Tunai: "+r(g(a.pay_cash||0))+" | Non-tunai: "+r(g(y(a)-(a.pay_cash||0))),1)):T("",!0)])]))),128))])])])])]))}};export{et as default};
