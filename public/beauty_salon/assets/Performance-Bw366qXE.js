import{_ as O,r as m,j as $,l as F,c as o,a as t,m as P,e as C,v as I,b as z,F as x,p as y,d as h,w as U,f as w,t as r,q as A,o as a}from"./index-CSnGshl7.js";const H={class:"max-w-7xl mx-auto space-y-6"},K={class:"bg-white p-4 rounded-xl shadow-sm border border-gray-100 space-y-4"},R={class:"flex flex-col sm:flex-row sm:items-center gap-2"},q={class:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden"},W={key:0,class:"px-6 py-12 text-center"},Y={key:1,class:"px-6 py-12 text-center text-gray-400"},G={key:2,class:"divide-y divide-gray-100 md:hidden"},J={class:"flex items-center justify-between mb-3"},Q={class:"flex items-center gap-3"},X={class:"w-10 h-10 rounded-full bg-pink-100 text-pink-600 flex items-center justify-center font-bold text-sm ring-2 ring-white shadow-sm"},Z={class:"font-semibold text-gray-900"},tt={class:"text-xs text-gray-500"},et=["onClick"],st={class:"flex flex-wrap gap-1.5"},at={class:"ml-1 font-bold text-pink-600"},nt={key:0,class:"text-xs text-gray-400 italic"},ot={class:"hidden md:block overflow-x-auto"},rt={class:"w-full text-left border-collapse"},it={class:"divide-y divide-gray-50"},lt={class:"px-6 py-4"},dt={class:"flex items-center gap-3"},ct={class:"w-8 h-8 rounded-full bg-pink-100 text-pink-600 flex items-center justify-center font-bold text-xs ring-2 ring-white shadow-sm"},pt={class:"font-medium text-gray-700"},ut={class:"px-6 py-4 text-sm text-gray-500"},xt={class:"flex flex-wrap gap-1.5"},yt={class:"ml-1 font-bold text-gray-800"},gt={class:"px-6 py-4 text-center"},ft=["onClick"],mt={class:"bg-white rounded-2xl w-full max-w-2xl shadow-2xl max-h-[80vh] flex flex-col animate-fade-in-down border border-gray-100"},ht={class:"p-4 border-b flex justify-between items-center bg-gray-50 rounded-t-2xl"},vt={class:"font-bold text-gray-800 flex items-center gap-2"},bt={class:"w-8 h-8 rounded-full bg-pink-600 text-white flex items-center justify-center text-xs shadow-md"},kt={class:"text-pink-600"},_t={class:"px-6 py-4 bg-gray-50/50 border-b border-gray-100"},wt={class:"flex flex-wrap gap-2"},Dt={class:"bg-pink-100 text-pink-700 px-1.5 py-0.5 rounded text-[10px] font-bold"},St={key:0,class:"text-xs text-gray-400 italic"},Bt={class:"p-0 overflow-y-auto flex-1"},jt={class:"w-full text-sm"},Tt={class:"divide-y divide-gray-100"},Ct={class:"px-4 py-3 text-gray-500 whitespace-nowrap font-mono text-xs"},It={class:"px-4 py-3 font-medium text-gray-700"},Mt={class:"px-4 py-3 text-gray-600"},Nt={key:0},Vt={class:"p-4 border-t bg-gray-50 rounded-b-2xl text-right flex justify-between items-center"},Lt={class:"text-sm text-gray-500 font-medium"},Et={__name:"Performance",setup(Ot){const v=m(!0),f=m([]),d=m(null),D=m([]),b=new Date,M=new Date(b.getFullYear(),b.getMonth(),1),S=i=>i.toISOString().split("T")[0],p=$({startDate:S(M),endDate:S(b)});async function N(){try{const e=await(await fetch("/api/Beauty_Salon/Therapists")).json();e.success&&(D.value=e.data)}catch{}}async function B(){const i=new Date(p.startDate),e=new Date(p.endDate),s=Math.abs(e-i);if(Math.ceil(s/(1e3*60*60*24))>31){alert(`❌ Rentang tanggal maksimal 31 hari!
Silakan pilih periode yang lebih pendek.`);return}v.value=!0;try{const u=await(await fetch("/api/Beauty_Salon/Orders")).json();u.success&&V(u.data)}catch(n){console.error(n)}finally{v.value=!1}}function V(i){const e={};D.value.forEach(n=>{e[n.id]={workerId:n.id,name:n.nama,totalTasks:0,tasks:[],statsByStep:{}}});const s=new Date(p.startDate),l=new Date(p.endDate);l.setHours(23,59,59),i.forEach(n=>{const u=n.order_date||n.created_at;if(!u)return;const T=new Date(u);T<s||T>l||n.status!=="cancelled"&&(n.order_items||[]).forEach(E=>{(E.work_steps||[]).forEach(g=>{if(g.worker_id&&g.status==="completed"){const c=g.worker_id;e[c]||(e[c]={workerId:c,name:"Terapis #"+c,totalTasks:0,tasks:[],statsByStep:{}}),e[c].totalTasks++,e[c].tasks.push({date:u,stepName:g.step_name,customerName:n.customer_name});const _=g.step_name||"Layanan";e[c].statsByStep[_]||(e[c].statsByStep[_]=0),e[c].statsByStep[_]++}})})}),f.value=Object.values(e).sort((n,u)=>u.totalTasks-n.totalTasks)}function k(i){return i?i.substring(0,2).toUpperCase():"??"}function L(i){if(!i)return"-";const e=new Date(i);return e.toLocaleDateString("id-ID",{day:"numeric",month:"short"})+" "+e.toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit"})}function j(i){i.tasks.sort((e,s)=>new Date(s.date)-new Date(e.date)),d.value=i}return F(async()=>{await N(),await B()}),(i,e)=>(a(),o("div",H,[t("div",K,[e[7]||(e[7]=t("div",null,[t("h1",{class:"text-xl md:text-2xl font-bold text-gray-800"},"Kinerja Terapis"),t("p",{class:"text-xs md:text-sm text-gray-500"},"Statistik pekerjaan dan layanan (Maksimal rentang 31 hari)")],-1)),t("div",R,[C(t("input",{type:"date","onUpdate:modelValue":e[0]||(e[0]=s=>p.startDate=s),class:"flex-1 border border-gray-300 rounded-lg px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-pink-200"},null,512),[[I,p.startDate]]),e[6]||(e[6]=t("span",{class:"text-gray-400 hidden sm:inline"},"—",-1)),C(t("input",{type:"date","onUpdate:modelValue":e[1]||(e[1]=s=>p.endDate=s),class:"flex-1 border border-gray-300 rounded-lg px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-pink-200"},null,512),[[I,p.endDate]]),t("button",{onClick:B,class:"bg-pink-600 hover:bg-pink-700 text-white px-6 py-2 rounded-lg text-sm font-medium transition shadow-lg flex items-center justify-center gap-2"},[...e[5]||(e[5]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})],-1),t("span",null,"Filter",-1)])])])]),t("div",q,[v.value?(a(),o("div",W,[...e[8]||(e[8]=[z('<div class="animate-pulse flex flex-col items-center gap-3" data-v-75aeed96><div class="w-16 h-16 bg-gray-200 rounded-full" data-v-75aeed96></div><div class="h-4 bg-gray-200 rounded w-32" data-v-75aeed96></div><div class="h-3 bg-gray-100 rounded w-48" data-v-75aeed96></div></div><p class="text-gray-400 mt-4" data-v-75aeed96>Memuat data...</p>',2)])])):f.value.length===0?(a(),o("div",Y,[...e[9]||(e[9]=[t("svg",{class:"w-16 h-16 mx-auto text-gray-300 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),t("p",{class:"font-medium text-gray-600"},"Tidak ada data kinerja",-1),t("p",{class:"text-sm"},"Pada periode yang dipilih",-1)])])):(a(),o("div",G,[(a(!0),o(x,null,y(f.value,s=>(a(),o("div",{key:s.workerId,class:"p-4 hover:bg-gray-50 transition"},[t("div",J,[t("div",Q,[t("div",X,r(k(s.name)),1),t("div",null,[t("p",Z,r(s.name),1),t("p",tt,r(s.tasks.length)+" layanan",1)])]),t("button",{onClick:l=>j(s),class:"px-3 py-1.5 bg-pink-50 text-pink-600 rounded-lg text-xs font-medium hover:bg-pink-100 transition"}," Detail ",8,et)]),t("div",st,[(a(!0),o(x,null,y(s.statsByStep,(l,n)=>(a(),o("span",{key:n,class:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-gray-50 border border-gray-200 text-gray-700"},[w(r(n),1),t("span",at,"("+r(l)+")",1)]))),128)),Object.keys(s.statsByStep).length===0?(a(),o("span",nt,"Belum ada layanan")):h("",!0)])]))),128))])),t("div",ot,[t("table",rt,[e[10]||(e[10]=t("thead",null,[t("tr",{class:"bg-gray-50 border-b border-gray-100 text-xs uppercase text-gray-500 font-semibold tracking-wider"},[t("th",{class:"px-6 py-4"},"Nama Terapis"),t("th",{class:"px-6 py-4 text-left"},"Layanan"),t("th",{class:"px-6 py-4 text-center"},"Aksi")])],-1)),t("tbody",it,[(a(!0),o(x,null,y(f.value,s=>(a(),o("tr",{key:s.workerId,class:"hover:bg-gray-50 transition duration-150"},[t("td",lt,[t("div",dt,[t("div",ct,r(k(s.name)),1),t("span",pt,r(s.name),1)])]),t("td",ut,[t("div",xt,[(a(!0),o(x,null,y(s.statsByStep,(l,n)=>(a(),o("span",{key:n,class:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-gray-50 border border-gray-200 text-gray-600"},[w(r(n)+" ",1),t("span",yt,"("+r(l)+")",1)]))),128))])]),t("td",gt,[t("button",{onClick:l=>j(s),class:"text-pink-600 hover:text-pink-800 text-sm font-medium hover:underline"},"Detail",8,ft)])]))),128))])])])]),(a(),P(A,{to:"body"},[d.value?(a(),o("div",{key:0,class:"fixed inset-0 z-[99] bg-black/40 backdrop-blur-sm flex items-center justify-center p-4",onClick:e[4]||(e[4]=U(s=>d.value=null,["self"]))},[t("div",mt,[t("div",ht,[t("h3",vt,[t("span",bt,r(k(d.value.name)),1),e[11]||(e[11]=w(" Detail Kinerja: ",-1)),t("span",kt,r(d.value.name),1)]),t("button",{onClick:e[2]||(e[2]=s=>d.value=null),class:"text-gray-400 hover:text-gray-600 transition text-xl"},"×")]),t("div",_t,[e[12]||(e[12]=t("h4",{class:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-3"},"Ringkasan Layanan",-1)),t("div",wt,[(a(!0),o(x,null,y(d.value.statsByStep,(s,l)=>(a(),o("div",{key:l,class:"px-3 py-1 bg-white border border-gray-200 rounded-lg text-xs font-medium text-gray-700 shadow-sm flex items-center gap-2"},[t("span",null,r(l),1),t("span",Dt,r(s),1)]))),128)),Object.keys(d.value.statsByStep).length===0?(a(),o("div",St,"Belum ada data.")):h("",!0)])]),t("div",Bt,[t("table",jt,[e[14]||(e[14]=t("thead",{class:"bg-gray-50 text-xs text-gray-500 uppercase sticky top-0 backdrop-blur-md bg-opacity-95"},[t("tr",null,[t("th",{class:"px-4 py-3 text-left"},"Tanggal"),t("th",{class:"px-4 py-3 text-left"},"Layanan"),t("th",{class:"px-4 py-3 text-left"},"Pelanggan")])],-1)),t("tbody",Tt,[(a(!0),o(x,null,y(d.value.tasks,(s,l)=>(a(),o("tr",{key:l,class:"hover:bg-gray-50"},[t("td",Ct,r(L(s.date)),1),t("td",It,r(s.stepName),1),t("td",Mt,r(s.customerName),1)]))),128)),d.value.tasks.length===0?(a(),o("tr",Nt,[...e[13]||(e[13]=[t("td",{colspan:"3",class:"px-4 py-8 text-center text-gray-400"},"Belum ada layanan selesai.",-1)])])):h("",!0)])])]),t("div",Vt,[t("span",Lt,"Total: "+r(d.value.tasks.length)+" Layanan",1),t("button",{onClick:e[3]||(e[3]=s=>d.value=null),class:"px-4 py-2 bg-white border border-gray-300 rounded-lg text-sm hover:bg-gray-50 font-medium text-gray-700 transition"},"Tutup")])])])):h("",!0)]))]))}},Ft=O(Et,[["__scopeId","data-v-75aeed96"]]);export{Ft as default};
